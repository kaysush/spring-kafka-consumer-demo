apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: kafka-scaledobject
  namespace: default
  labels:
    deploymentName: consumer-deployment
spec:
  scaleTargetRef:
    name: consumer-deployment
  pollingInterval: 5
  minReplicaCount: 1
  maxReplicaCount: 10  # Max can go upto num of partitions you have in the topic
  triggers:
    - type: kafka
      metadata:
        consumerGroup: my-kafka-consumer-group
        topic: keda-demo-topic
        lagThreshold: "10"
        offsetRestPolicy: latest
        sasl: "plaintext"
      authenticationRef:
      name: keda-kafka-credentials

---

apiVersion: keda.sh/v1alpha1
kind: TriggerAuthentication
metadata:
  name: keda-kafka-credentials
  namespace: default
spec:
  secretTargetRef:

    - parameter: username
      name: api-secrets
      key: api_key
    - parameter: password
      name: api-secrets
      key: api_secret
    - parameter: bootstrapServers
      name: api-secrets
      key: bootstrap_server


